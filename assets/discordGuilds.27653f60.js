import{m as s,p as i,q as r,s as d}from"./index.e95916f5.js";const a=s("discordGuilds",{state(){return{guilds:[],loading:!0,loaded:!1}},actions:{async loadGuilds(){try{const e=await i.get("/api/v1/discord/guilds");this.guilds=e.data.data.guilds,this.loading=!1,this.loaded=!0}catch(e){console.error(e)}},async loginGuild(e){r.inc();let o="https://discord.com/api/oauth2/authorize?";o+=`client_id=${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}.VITE_DISCORD_BOT_ID}&`,o+="permissions=8&",o+=`redirect_uri=${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}.VITE_FRONTEND_URL+{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}.VITE_DISCORD_BOT_CALLBACK_URL}&`,o+="response_type=code&",o+="scope=bot%20applications.commands&",o+=`guild_id=${e}&`,o+="disable_guild_select=true",window.open(o,"","width=500,height=900"),r.done(),window.router=d},async loginGuildCallback(e){try{const o=(await i.post(`/api/v1/discord/guilds?${e}`)).data;if(!window.opener||!window.opener.router)return;window.opener.router.push(`/discord/guilds/${o.data.guild.id}`),window.opener.router=void 0,window.close()}catch(o){console.error(o)}}}});export{a as u};
