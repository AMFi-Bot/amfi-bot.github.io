import{j as a,k as e,l as r,m as l}from"./index.e2698149.js";const n=a("discordGuilds",{state(){return{guilds:[],loading:!0,loaded:!1}},actions:{async loadGuilds(){try{const o=await e.get("/api/v1/discord/guilds");this.guilds=o.data.data.guilds,this.loading=!1,this.loaded=!0}catch(o){console.error(o)}},async loginGuild(o){r.inc();let s="https://discord.com/api/oauth2/authorize?";s+=`client_id=${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}.VITE_DISCORD_BOT_ID}&`,s+="permissions=8&",s+=`redirect_uri=${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}.VITE_FRONTEND_URL+{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}.VITE_DISCORD_BOT_CALLBACK_URL}&`,s+="response_type=code&",s+="scope=bot%20applications.commands&",s+=`guild_id=${o}&`,s+="disable_guild_select=true";const i=window.open(s,"","width=500,height=900");!i||(r.done(),await new Promise(t=>{const d=setInterval(async()=>{i.closed&&(clearInterval(d),t(void 0))},500)}),l.push(`/discord/guilds/${o}`))},async loginGuildCallback(o){try{await e.post(`/api/v1/discord/guilds?${o}`),window.close()}catch(s){console.error(s)}}}});export{n as u};
